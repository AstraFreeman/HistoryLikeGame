<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞—Å—è–Ω—Å: –Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        
        h1 {
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }
        
        #info-box {
            background: white;
            border-radius: 10px;
            padding: 15px 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            max-width: 800px;
            text-align: center;
            font-size: 14px;
            color: #333;
        }
        
        #game-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            width: 100%;
            max-width: 1400px;
        }
        
        #tableau {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 15px;
            width: 100%;
        }
        
        .tableau-column {
            min-height: 200px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            transition: background 0.3s;
        }
        
        .tableau-column.drag-over {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.8);
        }
        
        .card {
            width: 100%;
            min-height: 120px;
            background: white;
            border-radius: 8px;
            padding: 12px;
            cursor: grab;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            position: relative;
            font-size: 13px;
            line-height: 1.4;
            transition: transform 0.2s, box-shadow 0.2s;
            user-select: none;
        }
        
        .card:active {
            cursor: grabbing;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .card.dragging {
            opacity: 0.5;
        }
        
        .card.face-down {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: transparent;
            cursor: default;
        }
        
        .card.face-down:hover {
            transform: none;
        }
        
        .card.face-down::before {
            content: 'üá∫üá¶';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 40px;
        }
        
        .theme-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            position: absolute;
            top: 8px;
            right: 8px;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .card-number {
            position: absolute;
            top: 8px;
            left: 8px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .theme-kyivska-rus { background: linear-gradient(135deg, #FFD700, #FFA500); }
        .theme-kozactvo { background: linear-gradient(135deg, #DC143C, #8B0000); }
        .theme-revolyuciya { background: linear-gradient(135deg, #4169E1, #0000CD); }
        .theme-xx-century { background: linear-gradient(135deg, #9370DB, #4B0082); }
        
        #foundation-area {
            display: flex;
            justify-content: center;
            gap: 15px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .foundation-slot {
            width: 140px;
            height: 180px;
            border: 3px dashed rgba(255, 255, 255, 0.4);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            position: relative;
            transition: all 0.3s;
        }
        
        .foundation-slot.drag-over {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.8);
            transform: scale(1.05);
        }
        
        .foundation-slot .card {
            width: 100%;
            height: 100%;
            margin: 0;
        }
        
        .foundation-label {
            color: white;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            margin-top: 10px;
        }
        
        #controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 30px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: white;
            color: #667eea;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .card-count {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0,0,0,0.6);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>üá∫üá¶ –ü–∞—Å—è–Ω—Å: –Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏ üá∫üá¶</h1>
    <div id="info-box">
        <strong>–ü—Ä–∞–≤–∏–ª–∞:</strong> –ü–µ—Ä–µ—Ç—è–≥—É–π—Ç–µ –∫–∞—Ä—Ç–∫–∏ –º—ñ–∂ –∫–æ–ª–æ–Ω–∫–∞–º–∏. –ö–∞—Ä—Ç–∫–∏ –º–æ–∂–Ω–∞ –∫–ª–∞—Å—Ç–∏ –ª–∏—à–µ –Ω–∞ –∫–∞—Ä—Ç–∫–∏ —Ç—ñ—î—ó –∂ —Ç–µ–º–∏ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º –Ω–æ–º–µ—Ä–æ–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 3 –Ω–∞ 2). 
        –£ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç —Å–∫–ª–∞–¥–∞–π—Ç–µ –∫–∞—Ä—Ç–∫–∏ –∑–∞ –ø–æ—Ä—è–¥–∫–æ–º –≤—ñ–¥ 1 –¥–æ 6. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤—Å—ñ –∫–∞—Ä—Ç–∫–∏ —Ç–∞ –∑–±–µ—Ä—ñ—Ç—å —ó—Ö –∑–∞ —Ç–µ–º–∞–º–∏ —É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ö—Ä–æ–Ω–æ–ª–æ–≥—ñ—á–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É!
    </div>
    
    <div id="game-container">
        <div id="foundation-area">
            <div class="foundation-slot" data-theme="–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å">
                <div class="foundation-label">–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å<br>(1-6)</div>
            </div>
            <div class="foundation-slot" data-theme="–ö–æ–∑–∞—Ü—Ç–≤–æ">
                <div class="foundation-label">–ö–æ–∑–∞—Ü—Ç–≤–æ<br>(1-6)</div>
            </div>
            <div class="foundation-slot" data-theme="–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ä–µ–≤–æ–ª—é—Ü—ñ—è 1917">
                <div class="foundation-label">–†–µ–≤–æ–ª—é—Ü—ñ—è 1917<br>(1-6)</div>
            </div>
            <div class="foundation-slot" data-theme="–£–∫—Ä–∞—ó–Ω–∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –•–• —Å—Ç.">
                <div class="foundation-label">–•–• —Å—Ç–æ–ª—ñ—Ç—Ç—è<br>(1-6)</div>
            </div>
        </div>
        
        <div id="tableau"></div>
    </div>
    
    <div id="controls">
        <button id="reset-button">üîÑ –ù–æ–≤–∞ –≥—Ä–∞</button>
        <button id="hint-button">üí° –ü—ñ–¥–∫–∞–∑–∫–∞</button>
    </div>

    <script>
        const cards = [
            { id: 1, theme: '–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å', order: 1, content: '–ó–∞—Å–Ω—É–≤–∞–Ω–Ω—è –ö–∏—î–≤–∞, –ª–µ–≥–µ–Ω–¥–∞ –ø—Ä–æ –ö–∏–π, –©–µ–∫–∞ —Ç–∞ –•–æ—Ä–∏–≤–∞.' },
            { id: 2, theme: '–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å', order: 2, content: '–ö–Ω—è–≥–∏–Ω—è –û–ª—å–≥–∞ —Ç–∞ —ó—ó —Ä–µ—Ñ–æ—Ä–º–∏.' },
            { id: 3, theme: '–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å', order: 3, content: '–•—Ä–µ—â–µ–Ω–Ω—è –†—É—Å—ñ —É 988 —Ä–æ—Ü—ñ.' },
            { id: 16, theme: '–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å', order: 4, content: '–ö–Ω—è–∑—å –Ø—Ä–æ—Å–ª–∞–≤ –ú—É–¥—Ä–∏–π —Ç–∞ "–†—É—Å—å–∫–∞ –ø—Ä–∞–≤–¥–∞".' },
            { id: 17, theme: '–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å', order: 5, content: '–ü–µ—Ä—à–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –ö–∏—ó–≤—Å—å–∫–æ—ó –†—É—Å—ñ.' },
            { id: 18, theme: '–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å', order: 6, content: '–ë–∏—Ç–≤–∞ –Ω–∞ –ö–∞–ª—Ü—ñ 1223 —Ä–æ–∫—É.' },
            
            { id: 4, theme: '–ö–æ–∑–∞—Ü—Ç–≤–æ', order: 1, content: '–£—Ç–≤–æ—Ä–µ–Ω–Ω—è –ó–∞–ø–æ—Ä—ñ–∑—å–∫–æ—ó –°—ñ—á—ñ —É 1556 —Ä–æ—Ü—ñ.' },
            { id: 19, theme: '–ö–æ–∑–∞—Ü—Ç–≤–æ', order: 2, content: '–ì–µ—Ç—å–º–∞–Ω –ü–µ—Ç—Ä–æ –°–∞–≥–∞–π–¥–∞—á–Ω–∏–π.' },
            { id: 5, theme: '–ö–æ–∑–∞—Ü—Ç–≤–æ', order: 3, content: '–ë–æ–≥–¥–∞–Ω –•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π —Ç–∞ –ù–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ-–≤–∏–∑–≤–æ–ª—å–Ω–∞ –≤—ñ–π–Ω–∞.' },
            { id: 20, theme: '–ö–æ–∑–∞—Ü—Ç–≤–æ', order: 4, content: '–ë–µ—Ä–µ—Å—Ç–µ—Ü—å–∫–∞ –±–∏—Ç–≤–∞ 1651 —Ä–æ–∫—É.' },
            { id: 6, theme: '–ö–æ–∑–∞—Ü—Ç–≤–æ', order: 5, content: '–ö–æ–∑–∞—Ü—å–∫—ñ —Ç—Ä–∞–¥–∏—Ü—ñ—ó —Ç–∞ –≥–µ—Ç—å–º–∞–Ω—â–∏–Ω–∞.' },
            { id: 21, theme: '–ö–æ–∑–∞—Ü—Ç–≤–æ', order: 6, content: '–ö–æ–∑–∞—Ü—å–∫–∞ —Ä–∞–¥–∞.' },
            
            { id: 10, theme: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ä–µ–≤–æ–ª—é—Ü—ñ—è 1917', order: 1, content: '–£—Ç–≤–æ—Ä–µ–Ω–Ω—è –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—ó –†–∞–¥–∏.' },
            { id: 22, theme: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ä–µ–≤–æ–ª—é—Ü—ñ—è 1917', order: 2, content: '–ü–µ—Ä—à–∏–π –£–Ω—ñ–≤–µ—Ä—Å–∞–ª –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—ó –†–∞–¥–∏.' },
            { id: 23, theme: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ä–µ–≤–æ–ª—é—Ü—ñ—è 1917', order: 3, content: '–î—Ä—É–≥–∏–π –£–Ω—ñ–≤–µ—Ä—Å–∞–ª –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—ó –†–∞–¥–∏.' },
            { id: 11, theme: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ä–µ–≤–æ–ª—é—Ü—ñ—è 1917', order: 4, content: '–ü—Ä–æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –£–ù–† —É 1918 —Ä–æ—Ü—ñ.' },
            { id: 24, theme: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ä–µ–≤–æ–ª—é—Ü—ñ—è 1917', order: 5, content: '–ë—ñ–π –ø—ñ–¥ –ö—Ä—É—Ç–∞–º–∏ 1918 —Ä–æ–∫—É.' },
            { id: 12, theme: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ä–µ–≤–æ–ª—é—Ü—ñ—è 1917', order: 6, content: '–ê–∫—Ç –ó–ª—É–∫–∏ –£–ù–† —Ç–∞ –ó–£–ù–† 1919 —Ä–æ–∫—É.' },
            
            { id: 14, theme: '–£–∫—Ä–∞—ó–Ω–∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –•–• —Å—Ç.', order: 1, content: '–ß–æ—Ä–Ω–æ–±–∏–ª—å—Å—å–∫–∞ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞ 1986 —Ä–æ–∫—É.' },
            { id: 25, theme: '–£–∫—Ä–∞—ó–Ω–∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –•–• —Å—Ç.', order: 2, content: '–†–µ–≤–æ–ª—é—Ü—ñ—è –Ω–∞ –≥—Ä–∞–Ω—ñ—Ç—ñ 1990 —Ä–æ–∫—É.' },
            { id: 15, theme: '–£–∫—Ä–∞—ó–Ω–∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –•–• —Å—Ç.', order: 3, content: '–†–æ–∑–ø–∞–¥ –†–∞–¥—è–Ω—Å—å–∫–æ–≥–æ –°–æ—é–∑—É.' },
            { id: 13, theme: '–£–∫—Ä–∞—ó–Ω–∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –•–• —Å—Ç.', order: 4, content: '–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –£–∫—Ä–∞—ó–Ω–∏ —É 1991 —Ä–æ—Ü—ñ.' },
            { id: 26, theme: '–£–∫—Ä–∞—ó–Ω–∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –•–• —Å—Ç.', order: 5, content: '–ü—Ä–∏–π–Ω—è—Ç—Ç—è –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü—ñ—ó –£–∫—Ä–∞—ó–Ω–∏ —É 1996 —Ä–æ—Ü—ñ.' },
            { id: 27, theme: '–£–∫—Ä–∞—ó–Ω–∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –•–• —Å—Ç.', order: 6, content: '–ü–µ—Ä—à–∞ —É—á–∞—Å—Ç—å –£–∫—Ä–∞—ó–Ω–∏ –≤ –û–ª—ñ–º–ø—ñ–π—Å—å–∫–∏—Ö —ñ–≥—Ä–∞—Ö.' }
        ];

        let tableau = [];
        let foundation = {
            '–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å': [],
            '–ö–æ–∑–∞—Ü—Ç–≤–æ': [],
            '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ä–µ–≤–æ–ª—é—Ü—ñ—è 1917': [],
            '–£–∫—Ä–∞—ó–Ω–∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –•–• —Å—Ç.': []
        };
        let draggedCard = null;
        let draggedFrom = null;

        function shuffle(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function initializeGame() {
            const shuffled = shuffle(cards);
            tableau = Array(7).fill(null).map(() => []);
            foundation = {
                '–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å': [],
                '–ö–æ–∑–∞—Ü—Ç–≤–æ': [],
                '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ä–µ–≤–æ–ª—é—Ü—ñ—è 1917': [],
                '–£–∫—Ä–∞—ó–Ω–∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –•–• —Å—Ç.': []
            };

            let cardIndex = 0;
            for (let col = 0; col < 7; col++) {
                const cardsInColumn = col + 1;
                for (let row = 0; row < cardsInColumn && cardIndex < shuffled.length; row++) {
                    tableau[col].push({
                        ...shuffled[cardIndex],
                        faceUp: row === cardsInColumn - 1
                    });
                    cardIndex++;
                }
            }

            renderGame();
            updateInfoBox('–ì—Ä–∞ —Ä–æ–∑–ø–æ—á–∞—Ç–∞! –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤—Å—ñ –∫–∞—Ä—Ç–∫–∏ —Ç–∞ –∑–±–µ—Ä—ñ—Ç—å —ó—Ö –∑–∞ —Ç–µ–º–∞–º–∏ —É —Ö—Ä–æ–Ω–æ–ª–æ–≥—ñ—á–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É.');
        }

        function canPlaceOnTableau(card, targetColumn) {
            if (targetColumn.length === 0) return true;
            
            const topCard = targetColumn[targetColumn.length - 1];
            if (!topCard.faceUp) return false;
            
            return card.theme === topCard.theme && card.order === topCard.order - 1;
        }

        function canPlaceOnFoundation(card, theme) {
            if (card.theme !== theme) return false;
            
            const foundationPile = foundation[theme];
            
            if (foundationPile.length === 0) {
                return card.order === 1;
            }
            
            const topCard = foundationPile[foundationPile.length - 1];
            return card.order === topCard.order + 1;
        }

        function handleDragStart(e, card, columnIndex) {
            if (!card.faceUp) {
                e.preventDefault();
                return;
            }
            
            draggedCard = card;
            draggedFrom = { type: 'tableau', index: columnIndex };
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            document.querySelectorAll('.drag-over').forEach(el => {
                el.classList.remove('drag-over');
            });
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }

        function handleDragEnter(e) {
            if (e.currentTarget.classList.contains('tableau-column') || 
                e.currentTarget.classList.contains('foundation-slot')) {
                e.currentTarget.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            if (e.currentTarget.classList.contains('tableau-column') || 
                e.currentTarget.classList.contains('foundation-slot')) {
                e.currentTarget.classList.remove('drag-over');
            }
        }

        function handleDropOnTableau(e, targetColumnIndex) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            if (!draggedCard || draggedFrom.type !== 'tableau') return;
            
            const sourceColumn = tableau[draggedFrom.index];
            const targetColumn = tableau[targetColumnIndex];
            
            if (canPlaceOnTableau(draggedCard, targetColumn)) {
                const cardIndex = sourceColumn.findIndex(c => c.id === draggedCard.id);
                const movedCards = sourceColumn.splice(cardIndex);
                targetColumn.push(...movedCards);
                
                if (sourceColumn.length > 0) {
                    sourceColumn[sourceColumn.length - 1].faceUp = true;
                }
                
                updateInfoBox('–ö–∞—Ä—Ç–∫—É –ø–µ—Ä–µ–º—ñ—â–µ–Ω–æ!');
                renderGame();
            } else {
                if (targetColumn.length === 0) {
                    updateInfoBox('–ö–∞—Ä—Ç–∫—É –ø–µ—Ä–µ–º—ñ—â–µ–Ω–æ —É –ø–æ—Ä–æ–∂–Ω—é –∫–æ–ª–æ–Ω–∫—É!');
                    const cardIndex = sourceColumn.findIndex(c => c.id === draggedCard.id);
                    const movedCards = sourceColumn.splice(cardIndex);
                    targetColumn.push(...movedCards);
                    
                    if (sourceColumn.length > 0) {
                        sourceColumn[sourceColumn.length - 1].faceUp = true;
                    }
                    renderGame();
                } else {
                    const topCard = targetColumn[targetColumn.length - 1];
                    updateInfoBox(`–ù–µ–º–æ–∂–ª–∏–≤–æ! –ö–∞—Ä—Ç–∫–∏ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –æ–¥–Ω—ñ—î—ó —Ç–µ–º–∏ —Ç–∞ –π—Ç–∏ —É –∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É (${draggedCard.order} –º–∞—î –π—Ç–∏ –Ω–∞ ${draggedCard.order + 1})`);
                }
            }
            
            draggedCard = null;
            draggedFrom = null;
        }

        function handleDropOnFoundation(e, theme) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            if (!draggedCard || draggedFrom.type !== 'tableau') return;
            
            if (canPlaceOnFoundation(draggedCard, theme)) {
                const sourceColumn = tableau[draggedFrom.index];
                const cardIndex = sourceColumn.findIndex(c => c.id === draggedCard.id);
                
                if (cardIndex === sourceColumn.length - 1) {
                    sourceColumn.splice(cardIndex, 1);
                    foundation[theme].push(draggedCard);
                    
                    if (sourceColumn.length > 0) {
                        sourceColumn[sourceColumn.length - 1].faceUp = true;
                    }
                    
                    updateInfoBox(`–ö–∞—Ä—Ç–∫—É #${draggedCard.order} –¥–æ–¥–∞–Ω–æ –¥–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç—É "${theme}"!`);
                    renderGame();
                    checkWin();
                } else {
                    updateInfoBox('–£ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ –≤–µ—Ä—Ö–Ω—é –∫–∞—Ä—Ç–∫—É –∫–æ–ª–æ–Ω–∫–∏.');
                }
            } else {
                const foundationPile = foundation[theme];
                const expectedOrder = foundationPile.length + 1;
                if (draggedCard.theme !== theme) {
                    updateInfoBox(`–ö–∞—Ä—Ç–∫–∞ —Ç–µ–º–∏ "${draggedCard.theme}" –Ω–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç—É "${theme}".`);
                } else {
                    updateInfoBox(`–ö–∞—Ä—Ç–∫–∞ –º–∞—î –±—É—Ç–∏ –ø—ñ–¥ –Ω–æ–º–µ—Ä–æ–º ${expectedOrder}, –∞–ª–µ –≤–∞—à–∞ –∫–∞—Ä—Ç–∫–∞ #${draggedCard.order}.`);
                }
            }
            
            draggedCard = null;
            draggedFrom = null;
        }

        function renderGame() {
            const tableauEl = document.getElementById('tableau');
            tableauEl.innerHTML = '';

            tableau.forEach((column, colIndex) => {
                const colDiv = document.createElement('div');
                colDiv.className = 'tableau-column';
                colDiv.addEventListener('dragover', handleDragOver);
                colDiv.addEventListener('dragenter', handleDragEnter);
                colDiv.addEventListener('dragleave', handleDragLeave);
                colDiv.addEventListener('drop', (e) => handleDropOnTableau(e, colIndex));

                column.forEach((card, cardIndex) => {
                    const cardDiv = document.createElement('div');
                    cardDiv.className = 'card';
                    cardDiv.draggable = card.faceUp;
                    
                    if (!card.faceUp) {
                        cardDiv.classList.add('face-down');
                        cardDiv.draggable = false;
                    } else {
                        cardDiv.textContent = card.content;
                        
                        const number = document.createElement('div');
                        number.className = 'card-number';
                        number.textContent = card.order;
                        cardDiv.appendChild(number);
                        
                        const indicator = document.createElement('div');
                        indicator.className = 'theme-indicator';
                        
                        if (card.theme === '–ö–∏—ó–≤—Å—å–∫–∞ –†—É—Å—å') indicator.classList.add('theme-kyivska-rus');
                        else if (card.theme === '–ö–æ–∑–∞—Ü—Ç–≤–æ') indicator.classList.add('theme-kozactvo');
                        else if (card.theme === '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ä–µ–≤–æ–ª—é—Ü—ñ—è 1917') indicator.classList.add('theme-revolyuciya');
                        else if (card.theme === '–£–∫—Ä–∞—ó–Ω–∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –•–• —Å—Ç.') indicator.classList.add('theme-xx-century');
                        
                        cardDiv.appendChild(indicator);
                        
                        cardDiv.addEventListener('dragstart', (e) => handleDragStart(e, card, colIndex));
                        cardDiv.addEventListener('dragend', handleDragEnd);
                    }
                    
                    colDiv.appendChild(cardDiv);
                });

                tableauEl.appendChild(colDiv);
            });

            Object.entries(foundation).forEach(([theme, cards]) => {
                const slot = document.querySelector(`[data-theme="${theme}"]`);
                const existing = slot.querySelector('.card');
                if (existing) existing.remove();
                
                const label = slot.querySelector('.foundation-label');
                
                if (cards.length > 0) {
                    const topCard = cards[cards.length - 1];
                    const cardDiv = document.createElement('div');
                    cardDiv.className = 'card';
                    cardDiv.textContent = topCard.content;
                    
                    const number = document.createElement('div');
                    number.className = 'card-number';
                    number.textContent = topCard.order;
                    cardDiv.appendChild(number);
                    
                    const count = document.createElement('div');
                    count.className = 'card-count';
                    count.textContent = `${cards.length}/6`;
                    cardDiv.appendChild(count);
                    
                    slot.insertBefore(cardDiv, label);
                }
                
                slot.addEventListener('dragover', handleDragOver);
                slot.addEventListener('dragenter', handleDragEnter);
                slot.addEventListener('dragleave', handleDragLeave);
                slot.addEventListener('drop', (e) => handleDropOnFoundation(e, theme));
            });
        }

        function updateInfoBox(message) {
            document.getElementById('info-box').innerHTML = `<strong>–ü—Ä–∞–≤–∏–ª–∞:</strong> ${message}`;
        }

        function checkWin() {
            const totalInFoundation = Object.values(foundation).reduce((sum, arr) => sum + arr.length, 0);
            if (totalInFoundation === cards.length) {
                updateInfoBox('üéâ –í—ñ—Ç–∞—î–º–æ! –í–∏ –∑—ñ–±—Ä–∞–ª–∏ –≤—Å—ñ –∫–∞—Ä—Ç–∫–∏ —É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ö—Ä–æ–Ω–æ–ª–æ–≥—ñ—á–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É! –í–∏ –∑–Ω–∞—î—Ç–µ —ñ—Å—Ç–æ—Ä—ñ—é –£–∫—Ä–∞—ó–Ω–∏! üá∫üá¶');
            }
        }

        function showHint() {
            let hint = '–ü—ñ–¥–∫–∞–∑–∫–∞: ';
            let found = false;
            
            for (let i = 0; i < tableau.length; i++) {
                const column = tableau[i];
                if (column.length > 0) {
                    const topCard = column[column.length - 1];
                    if (topCard.faceUp) {
                        const canMoveToFoundation = canPlaceOnFoundation(topCard, topCard.theme);
                        if (canMoveToFoundation) {
                            hint += `–ö–∞—Ä—Ç–∫—É #${topCard.order} –∑ —Ç–µ–º–∏ "${topCard.theme}" –∑ –∫–æ–ª–æ–Ω–∫–∏ ${i + 1} –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ —É —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç!`;
                            found = true;
                            break;
                        }
                    }
                }
            }
            
            if (!found) {
                hint += '–°–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ –∫–∞—Ä—Ç–∫–∏ –º—ñ–∂ –∫–æ–ª–æ–Ω–∫–∞–º–∏, —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ –∑–∞–∫—Ä–∏—Ç—ñ –∫–∞—Ä—Ç–∫–∏! –®—É–∫–∞–π—Ç–µ –∫–∞—Ä—Ç–∫–∏ –∑ –ø–æ—Ä—è–¥–∫–æ–º 1 –¥–ª—è –ø–æ—á–∞—Ç–∫—É –∑–±–∏—Ä–∞–Ω–Ω—è —É —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç—ñ.';
            }
            
            updateInfoBox(hint);
        }

        document.getElementById('reset-button').addEventListener('click', initializeGame);
        document.getElementById('hint-button').addEventListener('click', showHint);

        initializeGame();
    </script>
</body>
</html>
