<!DOCTYPE html>
<html>
<head>
    <title>AR Урок: Дракар (Спрощено)</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- A-Frame Library -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <!-- AR.js Library for A-Frame -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

    <script>
    //========================================================================
    // JAVASCRIPT LOGIC
    //========================================================================
    AFRAME.registerComponent('lesson-manager', {
        init: function () {
            // Отримуємо посилання на елементи, якими будемо керувати
            const sceneEl = this.el;
            const drakkarModel = sceneEl.querySelector('#drakkar-model');
            const layer2Info = sceneEl.querySelector('#layer-2-info');
            const layer3Info = sceneEl.querySelector('#layer-3-info');
            const analysisButton = sceneEl.querySelector('#show-analysis-button');
            const resetButton = sceneEl.querySelector('#reset-button');

            // Функція для початкового стану (показуємо Шар 2)
            const showLayer2 = () => {
                drakkarModel.setAttribute('visible', true);
                layer2Info.setAttribute('visible', true);
                layer3Info.setAttribute('visible', false);
            };

            // Встановлюємо початковий стан при завантаженні
            showLayer2();

            // Обробник для кнопки "Перейти до аналізу"
            analysisButton.addEventListener('click', () => {
                layer2Info.setAttribute('visible', false);
                layer3Info.setAttribute('visible', true);
            });

            // Обробник для кнопки "Почати знову"
            resetButton.addEventListener('click', () => {
                showLayer2();
            });
        }
    });
    </script>
</head>

<body style='margin: 0px; overflow: hidden;'>
    <a-assets>
        <!-- Моделі посилаються на локальні шляхи у папці 'models' -->
        <a-asset-item id="drakkar-glb" src="models/drakar.glb"></a-asset-item>
        <a-asset-item id="viking-inter-glb" src="models/viking_inter.glb"></a-asset-item>

        <!-- 
            ВАЖЛИВО: Замініть посилання на ваші власні .patt файли маркерів.
            Генератор: https://jeromeetienne.github.io/AR.js/three.js/examples/marker-training/examples/generator.html
        -->
        <a-asset-item id="drakkar-patt" src="https://raw.githack.com/AR-js-org/AR.js/master/data/patt.hiro"></a-asset-item>
        <a-asset-item id="pobut-patt" src="https://raw.githack.com/AR-js-org/AR.js/master/data/patt.kanji"></a-asset-item>
    </a-assets>

    <!-- AR Сцена. Налаштування arjs мінімальні, як ви просили. -->
    <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false;'>

        <!-- ================================================================= -->
        <!-- МАРКЕР 1: УРОК ПРО ДРАКАР                                         -->
        <!-- ================================================================= -->
        <a-marker type='pattern' url='#drakkar-patt'>
            <a-entity id="drakkar-lesson-container" lesson-manager>

                <!-- 3D-модель Дракара (видна одразу) -->
                <a-entity id="drakkar-model" gltf-model="#drakkar-glb" scale="0.1 0.1 0.1" position="0 0 0" rotation="-90 0 0"></a-entity>

                <!-- Шар 2: Інформаційні панелі (видні одразу) -->
                <a-entity id="layer-2-info">
                    <a-entity position="-1.2 0.5 0">
                        <a-plane width="1.2" height="1" color="#333"></a-plane>
                        <a-text value="Голова дракона: Символ статусу та елемент психологічної війни для залякування ворогів." align="left" width="1.1" position="-0.55 0.25 0.01"></a-text>
                    </a-entity>
                    <a-entity position="1.2 0.5 0">
                        <a-plane width="1.2" height="1" color="#333"></a-plane>
                        <a-text value="Мілка осадка (до 1м): Ключ до успіху! Дозволяла ходити річками та атакувати міста далеко від моря." align="left" width="1.1" position="-0.55 0.25 0.01"></a-text>
                    </a-entity>
                    <a-entity position="0 -1.1 0">
                        <a-plane width="2.2" height="1" color="#333"></a-plane>
                         <a-text value="Карта: Мілка осадка дозволяла варягам долати 'шлях із варягів у греки', перетягуючи човни суходолом ('волоки')." align="center" width="2" position="0 0.2 0.01"></a-text>
                    </a-entity>
                    <a-plane id="show-analysis-button" class="clickable" position="0 1.3 0" width="1.5" height="0.4" color="#4CC3D9"><a-text value="Перейти до аналізу" align="center" color="black" width="1.4"></a-text></a-plane>
                </a-entity>
                
                <!-- Шар 3: Аналітичне завдання (прихований) -->
                <a-entity id="layer-3-info" visible="false">
                    <a-text value="Проблема: Варяги для слов'ян: завойовники чи організатори?" align="center" width="3.5" position="0 1.6 0"></a-text>
                    <a-entity position="-1.5 0 0">
                        <a-plane width="1.8" height="2.2" color="#544231"></a-plane>
                        <a-text value="Джерело 1 (Повість временних літ): 'Земля наша велика і багата, а порядку в ній немає. Ідіть-но княжити і володіти нами.'" align="left" width="1.6" position="-0.8 0.6 0.01" color="#FFF"></a-text>
                    </a-entity>
                    <a-entity position="1.5 0 0">
                        <a-plane width="1.8" height="2.2" color="#544231"></a-plane>
                        <a-text value="Джерело 2 (Погляд істориків): 'Легенда про 'запрошення' могла бути виправданням влади. Насправді, варяги силою підкорювали племена і накладали важку данину.'" align="left" width="1.6" position="-0.8 0.6 0.01" color="#FFF"></a-text>
                    </a-entity>
                    <a-plane id="reset-button" class="clickable" position="0 -1.5 0" width="1.2" height="0.4" color="#FFC300"><a-text value="Повернутись" align="center" color="black" width="1.1"></a-text></a-plane>
                </a-entity>

            </a-entity>
        </a-marker>

        <!-- ================================================================= -->
        <!-- МАРКЕР 2: ПОБУТ ВІКІНГІВ                                          -->
        <!-- ================================================================= -->
        <a-marker type='pattern' url='#pobut-patt'>
            <a-entity id="viking-inter-model" gltf-model="#viking-inter-glb" scale="0.5 0.5 0.5" position="0 0.5 0" rotation="0 0 0"></a-entity>
            <a-plane width="2.5" height="1.2" color="#333" position="0 -0.8 0" rotation="-90 0 0">
                <a-text 
                    value="Побут вікінгів: Вікінги були не лише воїнами, а й вправними ремісниками, фермерами та торговцями. Їхні інструменти, як-от сокира, були універсальними: для будівництва, рубки лісу та як зброя в бою."
                    align="center"
                    width="2.3"
                    color="#FFFFFF">
                </a-text>
            </a-plane>
        </a-marker>
        
        <!-- Проста камера з курсором для взаємодії -->
        <a-entity camera><a-cursor></a-cursor></a-entity>
    </a-scene>
</body>
</html>
